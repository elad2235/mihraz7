pipeline {
    agent { docker 'python:3-alpine' } 
    stages {
			stage('Setup Dependency') {
				steps {
					    withEnv(["HOME=${env.WORKSPACE}"]) {
					      sh "pip install -r requirements.txt --user"

    					}
				}


        }
			stage('Run Tests') {
				steps {
					    withEnv(["HOME=${env.WORKSPACE}"]) {
					      sh "python -m unittest discover mihraz7/"
    					}
						
				}
			}
	}


	post {
    failure {
        mail to: 'eladpe@ac.sce.ac.com',
             subject: "Failed Pipeline: ${currentBuild.fullDisplayName}",
             body: "Something is wrong with ${env.BUILD_URL}"
    }
}


}
